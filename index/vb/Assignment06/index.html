<!DOCTYPE html>

<html lang="en">

    <head>
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
            
        <meta name="description" content="The Department of Computer Information Systems at Buffalo State College provides a four year undergraduate degree program in information technology, systems administration, network administration, internet programming, databse programming, and project management."/>
        
        <meta name="keywords" content="buffalo state college, computer information systems, cis, buffalo, undergraduate, IT, college, SUNY, State University of New York, information technology, 413, internet programmin, html5, css, javascript, jquery, adobe flash, RIA."/>
        
        <link rel="icon" href="../../images/programming.ico">
        
        <title>Assignment 6 Code</title>
        
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        
        <link href="../../css/sticky-footer-navbar.css" rel="stylesheet">
        
    </head>
    
    <style>
        #profile
        {
            float: left;
            padding: 10px;
            width: 10%;
            height: 10%;
        }
    </style>

    <body>

        <!-- Fixed navbar -->
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">Hello World!</a>
                </div>
                <div id="navbar" class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="../../index.html">Home</a></li>
                        <li class="active"><a href="../index.html">Visual Basic</a></li>
                        <li><a href="../../413/index.html">HTML | CSS | JavaScript</a></li>
                        <li><a href="../../475/index.php">PHP</a></li>
                        <li><a href="../../index.html">C#</a></li>
                        <li><a href="../../resume/index.html">R&eacute;sum&eacute;</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Assignments <span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                            
                                <li class="dropdown-header">CIS 400</li>
                                <li><a href="../Assignment01/index.html">Assignment #1</a></li>
                                <li><a href="../Assignment02/index.html">Assignment #2</a></li>
                                <li><a href="../Assignment03/index.html">Assignment #3</a></li>
                                <li><a href="../Assignment04/index.html">Assignment #4</a></li>
                                <li><a href="../Assignment05/index.html">Assignment #5</a></li>
                                <li class="active"><a>Assignment #6</a></li>
                                <li><a href="../Assignment07/index.html">Assignment #7</a></li>
                                <li><a href="../Assignment08/index.html">Assignment #8</a></li>
                                <li><a href="../Assignment09/index.html">Assignment #9</a></li>
                                <li class="divider"></li>
                                
                                <li class="dropdown-header">CIS 413</li>
                                <li><a href="../../413/hw1/index.html">Homework #1</a></li>
                                <li><a href="../../413/hw2/index.html">Homework #2</a></li>
                                <li><a href="../../413/hw3/index.html">Homework #3</a></li>
                                <li class="divider"></li>
                                
                                <li class="dropdown-header">CIS 475</li>
                                <li><a href="../../475/class1/index.php">In Class #1</a></li>
                                <li><a href="../../475/class2/index.php">In Class #2</a></li>
                                <li><a href="../../475/class3/index.php">In Class #3</a></li>
                                <li><a href="../../475/shapes/index.php">Homework #1</a></li>
                                <li><a href="../../475/valid/index.php">Homework #2</a></li>
                                <li><a href="../../475/project1/login.php">Final Project (Part 1)</a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        
        <!-- Begin page content -->
        <div class="container">
            <div class="page-header">
                <h1>Assignment 6 <small>Description and Code</small></h1>
            </div>
            <p class="lead">For this assignment use Visual Basic to implement a test generator to replace a traditional hardcopy test. This project will involve three forms.
            <ul>
                <li>An opening form which will read the data from the file.</li>
                <li>An intermediate form in which users will be able to select the number of questions (5-10).</li>
                <li>A form that presents the questions and records users' responses.</li>
                <li>Use FileGet to read the questions (in this assignment there are 10), choices, and correct answers from a file called Test1.dat into the structured array test.</li>
                <li>Use a MsgBox/MessageBox to create a summary of the test showing the correct answers, the user's responses, and their score.</li>
                <li>There will be a penalty for each incorrect answer, which will be have the value of half a correct answer.</li>
                <li>Forms will be modeless.</li>
                <li>Once the test has begun, the test taker cannot go back to previous questions and must complete the test.</li>
                <li>When the final question is presented, instead of a Next button, a Finished button is displayed.</li>
            </ul>
            </p>
            <br>
                
            <p>Below is the code used to create the program:</p>
            <br>
            <p>frmMain</p>
            <pre>
Option Explicit On

Public Class frmMain
    Private Sub frmMain_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        completed = False ' this is set to zero because the test has not been completed when this form first loads

        FileOpen(1, "Test1.dat", OpenMode.Random, , , Len(test(0)))

        Dim inputCounter As Integer ' the lines below are to read questions, choices, and correct answers from a file called Test1.dat
        inputCounter = 0
        While inputCounter < MaxNoOfQuestions
            FileGet(1, test(inputCounter))
            inputCounter = inputCounter + 1
        End While

        FileClose(1)

    End Sub
    Private Sub cmdTest_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdTest.Click

        If (completed) Then ' this tests whether or not the test has been taken and does not allow the test to be taken a second time
            MsgBox("You have already taken the test!", MsgBoxStyle.Exclamation, "Error!")
            Exit Sub
        End If

        frmNumQuest.Visible = True ' show the next form
        Me.Visible = False         ' hide the current form

    End Sub
    Private Sub cmdExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdExit.Click

        Me.Close() ' close the current form

    End Sub
End Class
            </pre>
            <br>
            <p>frmPresentTest</p>
            <pre>
Option Explicit On

Public Class frmPresentTest

    Private Sub frmPresentTest_Activated(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Activated

        completed = True ' this is set to true because the test has now been taken

        ShowQuestion(counter) ' this calls the sub that displays the questions and options

        cmdFinish.Visible = False ' this hides the finish button
        cmdNext.Visible = True ' this shows the next question button

        If counter = (finalQuest - 1) Then ' this hides the next question button and shows the finish button if the first question is also the last question
            cmdNext.Visible = False
            cmdFinish.Visible = True
        End If

    End Sub

    '========================================================================================================================
    ' this sub assigns the question or choice stored in test at location x to its corresponding label or radio button and 
    ' also sets all of the radio buttons to false so that no answer is selected until the user clicks one
    '========================================================================================================================

    Sub ShowQuestion(ByVal x As Integer)

        lblQuest.Text = test(x).question
        optChoiceA.Text = test(x).choiceA
        optChoiceB.Text = test(x).choiceB
        optChoiceC.Text = test(x).choiceC
        optChoiceD.Text = test(x).choiceD
        optChoiceA.Checked = False
        optChoiceB.Checked = False
        optChoiceC.Checked = False
        optChoiceD.Checked = False

    End Sub

    Private Sub cmdNext_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdNext.Click

        ' the if test below is storing the users answers every time next question is clicked
        If (optChoiceA.Checked) Then
            answers(counter) = "A"
        ElseIf (optChoiceB.Checked) Then
            answers(counter) = "B"
        ElseIf (optChoiceC.Checked) Then
            answers(counter) = "C"
        ElseIf (optChoiceD.Checked) Then
            answers(counter) = "D"
        Else
            answers(counter) = "*"
        End If

        counter = counter + 1 ' this counts to the last question

        ' these lines change the question and question number each time the next question button is clicked
        ShowQuestion(counter)
        lblQuestNum.Text = lblQuestNum.Text + 1

        If counter = (finalQuest - 1) Then ' this changes the next question button to the finish button when the last question is reached
            cmdNext.Visible = False
            cmdFinish.Visible = True
        End If

    End Sub

    Private Sub cmdFinish_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdFinish.Click

        Dim correctAnswer, wrongAnswer, testScore As Double
        Dim x As Integer
        Dim message As String

        ' the if test below is storing the users answers when finished is clicked
        If (optChoiceA.Checked) Then
            answers(counter) = "A"
        ElseIf (optChoiceB.Checked) Then
            answers(counter) = "B"
        ElseIf (optChoiceC.Checked) Then
            answers(counter) = "C"
        ElseIf (optChoiceD.Checked) Then
            answers(counter) = "D"
        Else
            answers(counter) = "*"
        End If

        correctAnswer = 100 / finalQuest ' this calculates the worth of each right answer based on how many questions are being asked
        wrongAnswer = correctAnswer / 2 ' this calculates the worht of each wrong answer based on how many questions are being asked
        testScore = 0 ' the final test score is to be stored in this variable

        message = "                 Correct Answer          Your Answer" & vbLf & vbLf

        ' ========================================================================================================================
        ' these lines are written as per the description of the assignment specifically number 9 under other considerations

        For x = 0 To finalQuest - 1
            Select Case answers(x)
                Case Is = test(x).correctAnswer
                    testScore = testScore + correctAnswer
                Case Is = "*"
                    testScore = testScore
                Case Else
                    testScore = testScore - wrongAnswer
            End Select
            message = message & "                               " & test(x).correctAnswer & "                               " & answers(x) & vbLf
        Next x

        message = message & vbLf & vbLf & "     * indicates that you did not answer that question." & vbLf & vbLf & vbLf & "                                    Your score is:  " & Math.Round(testScore)

        MsgBox(message, MsgBoxStyle.OkOnly, "Test Results")
        ' ========================================================================================================================

        frmMain.Visible = True
        Me.Visible = False

    End Sub
End Class
            </pre>
            <br>
            <p>frmNumQuest</p>
            <pre>
Option Explicit On

Public Class frmNumQuest

    Private Sub cmdBegin_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdBegin.Click

        frmPresentTest.Visible = True ' show the next form
        Me.Visible = False            ' hide the current form

    End Sub

    Private Sub frmNumQuest_Activated(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Activated

        Dim x, y As Integer ' these variables will be used to populate the list containing numbers for the number of questions
        x = MinNoOfQuestions
        y = MaxNoOfQuestions

        Do While x <= y ' this loop will populate the list based on the minimum and maximum number of questions
            lstNoOfQuest.Items.Add(Str(x))
            x = x + 1
        Loop

        lstNoOfQuest.SelectedIndex = MaxNoOfQuestions - MinNoOfQuestions ' this line highlights the maximum number of questions as the default

        counter = 0 ' this is set to zero here instead of on frmPresentTest so that it isn't assigned 0 every time frmPresentTest is activated

    End Sub

    Private Sub lstNoOfQuest_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lstNoOfQuest.SelectedIndexChanged

        finalQuest = lstNoOfQuest.SelectedIndex + MinNoOfQuestions ' this line determines what number question will be the last question

    End Sub
End Class
            </pre>
            <br>
            <p>modTest</p>
            <pre>
Option Explicit On

Module modTest

    '========================================================================================================================
    ' Thes lines of code below are directly from the assignment description. FileGet is to be used to read questions, 
    ' choices, and correct answers from a file called Test1.dat into the structured array test defined below.

    Structure testQuestion
        &lt;VBFixedString(100)&gt Public question As String
        &lt;VBFixedString(30)&gt Public choiceA As String
        &lt;VBFixedString(30)&gt Public choiceB As String
        &lt;VBFixedString(30)&gt Public choiceC As String
        &lt;VBFixedString(30)&gt Public choiceD As String
        &lt;VBFixedString(1)&gt Public correctAnswer As String
    End Structure

    Public Const MaxNoOfQuestions = 10
    Public test(MaxNoOfQuestions - 1) As testQuestion
    '========================================================================================================================

    Public Const MinNoOfQuestions = 5 ' this constant will be the minimum number of questions in the test

    Public completed As Boolean ' this variable will be set to true when the test is completed so that it cannot be taken again

    Public finalQuest As Integer ' this varaible will contain what the final question as choosen by the user

    Public counter As Integer ' this variable will be used to change the question and answer choices the user sees

    Public answers(MaxNoOfQuestions - 1) As String

End Module
            </pre>
        </div>
        
        <footer class="footer">
            <div class="container">
                <a href="https://www.linkedin.com/pub/raul-matos/116/831/538">
                <img src="../../images/profile.JPG" id="profile">
                </a>
                <p class="text-muted"><strong>Raul G. Matos | <a href="https://www.linkedin.com/pub/raul-matos/116/831/538">View my LinkedIn profile</a> | <a href="https://github.com/RaulGMatos">View my GitHub profile</a></strong><br>
                    <i><small>Department of Computer Information Systems Graduate</small></i><br>
                    <i><small>Buffalo State College</small></i><br>
                    <i><small>1300 Elmwood Avenue</small></i><br>
                    <i><small>Buffalo, New York 14222</small></i>
                </p>
            </div>
        </footer>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        
    </body>

</html>