<!DOCTYPE html>

<html lang="en">

    <head>
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
            
        <meta name="description" content="The Department of Computer Information Systems at Buffalo State College provides a four year undergraduate degree program in information technology, systems administration, network administration, internet programming, databse programming, and project management."/>
        
        <meta name="keywords" content="buffalo state college, computer information systems, cis, buffalo, undergraduate, IT, college, SUNY, State University of New York, information technology, 413, internet programmin, html5, css, javascript, jquery, adobe flash, RIA."/>
        
        <link rel="icon" href="../../images/programming.ico">
        
        <title>Assignment 9 Code</title>
        
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        
        <link href="../../css/sticky-footer-navbar.css" rel="stylesheet">
        
    </head>
    
    <style>
        #profile
        {
            float: left;
            padding: 10px;
            width: 10%;
            height: 10%;
        }
    </style>

    <body>

        <!-- Fixed navbar -->
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">Hello World!</a>
                </div>
                <div id="navbar" class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="../../index.html">Home</a></li>
                        <li class="active"><a href="../index.html">Visual Basic</a></li>
                        <li><a href="../../413/index.html">HTML | CSS | JavaScript</a></li>
                        <li><a href="../../475/index.php">PHP</a></li>
                        <li><a href="../../index.html">C#</a></li>
                        <li><a href="../../resume/index.html">R&eacute;sum&eacute;</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Assignments <span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                            
                                <li class="dropdown-header">CIS 400</li>
                                <li><a href="../Assignment01/index.html">Assignment #1</a></li>
                                <li><a href="../Assignment02/index.html">Assignment #2</a></li>
                                <li><a href="../Assignment03/index.html">Assignment #3</a></li>
                                <li><a href="../Assignment04/index.html">Assignment #4</a></li>
                                <li><a href="../Assignment05/index.html">Assignment #5</a></li>
                                <li><a href="../Assignment06/index.html">Assignment #6</a></li>
                                <li><a href="../Assignment07/index.html">Assignment #7</a></li>
                                <li><a href="../Assignment08/index.html">Assignment #8</a></li>
                                <li class="active"><a>Assignment #9</a></li>
                                <li class="divider"></li>
                                
                                <li class="dropdown-header">CIS 413</li>
                                <li><a href="../../413/hw1/index.html">Homework #1</a></li>
                                <li><a href="../../413/hw2/index.html">Homework #2</a></li>
                                <li><a href="../../413/hw3/index.html">Homework #3</a></li>
                                <li class="divider"></li>
                                
                                <li class="dropdown-header">CIS 475</li>
                                <li><a href="../../475/class1/index.php">In Class #1</a></li>
                                <li><a href="../../475/class2/index.php">In Class #2</a></li>
                                <li><a href="../../475/class3/index.php">In Class #3</a></li>
                                <li><a href="../../475/shapes/index.php">Homework #1</a></li>
                                <li><a href="../../475/valid/index.php">Homework #2</a></li>
                                <li><a href="../../475/project1/login.php">Final Project (Part 1)</a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        
        <!-- Begin page content -->
        <div class="container">
            <div class="page-header">
                <h1>Assignment 9 <small>Description and Code</small></h1>
            </div>
            <p class="lead">Use Visual Basic to create an interface that allows users to see movie information and play movie trailers. These movie trailers are password protected.
            <ul>
                <li>Use ReadLine to read in the passwords shown below from the indicated text file into an array. When dimensioning your password array, assume that the number of passwords will not exceed ten. After reading the data until EOF (end of file), use this array to check to see if the password enter by the user is correct.</li>
                <li>Use FileGet to read the information on the movies from a structured file named movies.dat into an array.</li>
                <li>Display a form that allows users to use command buttons to navigate and view information on any of the movies.</li>
                <li>Allow users to click the Play button to play a movie trailer (approximately 18 seconds long) and click the Close button, if they wish to stop playing the trailer before it ends. Include two additional buttons; Pause and Resume.</li>
                <li>Include an Exit button that closes both forms.</li>
                <li>When the user types the password, solid black circles will appear instead of the actual characters.</li>
                <li>Allow the user two chances to enter a valid password and then terminate the program.</li>
            </ul>
            </p>
            <br>
                
            <p>Below is the code used to create the program:</p>
            <br>
            <p>frmMain</p>
            <pre>
Option Explicit On

Public Class frmMain
    '========================================================================================================================
    ' These lines of code below are directly from the assignment description.
    Public Structure movieInfo
        &lt;VBFixedString(30)&gt Public title As String
        &lt;VBFixedString(20)&gt Public star As String
        Public duration As Integer
        Public year As Integer
        &lt;VBFixedString(5)&gt Public rating As String
        &lt;VBFixedString(15)&gt Public movieFileName As String
    End Structure

    Public Const noOfMovies = 3
    Public movies(noOfMovies - 1) As movieInfo
    ' -----------------------------------------------------------------------------------------------------------------------
    Private Declare Function mciSendString Lib "winmm.dll" Alias "mciSendStringA" (ByVal _
     lpstrCommand As String, ByVal lpstrReturnString As String, ByVal uReturnLength As _
          Integer, ByVal hwndCallback As Integer) As Integer
    '========================================================================================================================

    Public index As Integer         ' this will be used with the DisplayMovie() sub to track which trailer info is to be displayed (as requested in the assignment description)
    Dim trailer As String

    Private Sub frmMain_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        Dim count As Integer        ' this will be used with the for loop below

        ' the lines below are opening the video.dat file, getting the trailer info from the file, and closing the file
        FileOpen(1, "video.dat", OpenMode.Random, , , Len(movies(0)))

        For count = 0 To noOfMovies - 1
            FileGet(1, movies(count))
        Next

        FileClose()

        index = 0

        cmdPrev.Visible = False         ' hide the previous button
        cmdNext.Visible = True          ' show the next button

        DisplayMovie(index)      ' this is calling the sub DisplayMovie() which will display the trailer information

    End Sub

    Public Sub DisplayMovie(ByVal x As Integer)     ' this sub displays all of the information from the video.dat file

        lblTitle.Text = movies(x).title
        lblStar.Text = movies(x).star
        lblDuration.Text = movies(x).duration & " min."
        lblFirst.Text = movies(x).year
        lblRate.Text = movies(x).rating
        trailer = movies(x).movieFileName

    End Sub

    Private Sub cmdPrev_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdPrev.Click

        index = index - 1       ' this is decreased everytime previous is clicked to decrease the index or page number
        DisplayMovie(index)      ' this calls the DisplayMovie() sub with the updated index or page number

        ' this if test is testing if the user has reached the fist page of info, if so hide the previous button
        If (index > 0) Then
            cmdNext.Visible = True
        Else
            cmdPrev.Visible = False
        End If

        mciSendString("close movie", 0, 0, 0) ' this line is used to close the video if it is playing when the previous button is clicked

    End Sub

    Private Sub cmdNext_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdNext.Click

        index = index + 1       ' this is increased everytime next is clicked to increase the index or page number
        DisplayMovie(index)      ' this calls the DisplayMovie() sub with the updated index or page number

        ' this if test is testing if the user has reached the last page of info, if so hide the next button
        If (index < noOfMovies - 1) Then
            cmdPrev.Visible = True
        Else
            cmdNext.Visible = False
        End If

        mciSendString("close movie", 0, 0, 0) ' this line is used to close the video if it is playing when the next button is clicked

    End Sub

    Private Sub cmdExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdExit.Click

        Me.Close()              ' close this form
        frmPassword.Close()     ' close frmPassword

    End Sub

    Private Sub cmdPlay_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdPlay.Click

        ' the code below is taken directly from the assignment description and lecture video for this assignment

        mciSendString("close movie", 0, 0, 0)  ' close the movie if it is playing

        mciSendString("open " & trailer & " type mpegvideo alias movie parent " _
         & picMoviePlayer.Handle.ToInt32 & " style child", 0, 0, 0)  ' open the movie

        mciSendString("play movie", 0, 0, 0)  ' play the movie

    End Sub

    Private Sub cmdPause_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdPause.Click
        mciSendString("pause movie", 0, 0, 0)  ' pause the movie if it is playing
    End Sub

    Private Sub cmdResume_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdResume.Click
        mciSendString("resume movie", 0, 0, 0)  ' resume the movie if it is paused
    End Sub

    Private Sub cmdClose_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdClose.Click
        mciSendString("close movie", 0, 0, 0)  ' close the movie
    End Sub
End Class
            </pre>
            
            <br>
            <p>frmPassword</p>
            <pre>
Option Explicit On
Imports System.IO

Public Class frmPassword

    Public passArray(9) As String   ' holds the passwords read from the passwords.txt file
    Public passCount As Integer     ' keeps track of how many passwords are being/have been read
    Public attempts As Integer      ' holds the number of password attempts made by the user

    Private Sub frmPassword_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        Dim readPasswords As StreamReader

        attempts = 0
        passCount = 0

        ' the lines below open the password.txt file, save the contents in passArray(), and close the password.txt file
        readPasswords = File.OpenText("passwords.txt")

        While (readPasswords.Peek <> -1)
            passArray(passCount) = readPasswords.ReadLine
            passCount = passCount + 1
        End While

        readPasswords.Close()

    End Sub

    Private Sub cmdOK_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdOK.Click

        Dim correctPass As Boolean  ' true if password is correct, false if not
        Dim x As Integer            ' for use in the do loop below

        correctPass = False
        x = passCount - 1

        ' the Do Loop below is testing if the password in txtPass matches any one of the passwords in passArray()
        Do Until (x < 0)

            If (txtPass.Text = passArray(x)) Then
                correctPass = True
            End If

            x = x - 1

        Loop

        ' this if test displays the appropriate message box for a wrong password, and hides this form and shows frmMain for a right password
        If (correctPass = False) Then

            attempts = attempts + 1

            If (attempts = 1) Then
                MsgBox("Please retype password, you have 1 try left!", MsgBoxStyle.OkOnly, "Password Incorrect!")
                txtPass.Clear()
                txtPass.Focus()
            End If

            If (attempts = 2) Then
                MsgBox("You have attempted 2 times. The program will now terminate!", MsgBoxStyle.OkOnly, "Program Termination!")
                Me.Close()
            End If

        Else

            Me.Visible = False
            frmMain.Visible = True

        End If

    End Sub
End Class
            </pre>
        </div>
        
        <footer class="footer">
            <div class="container">
                <a href="https://www.linkedin.com/pub/raul-matos/116/831/538">
                <img src="../../images/profile.JPG" id="profile">
                </a>
                <p class="text-muted"><strong>Raul G. Matos | <a href="https://www.linkedin.com/pub/raul-matos/116/831/538">View my LinkedIn profile</a> | <a href="https://github.com/RaulGMatos">View my GitHub profile</a></strong><br>
                    <i><small>Department of Computer Information Systems Graduate</small></i><br>
                    <i><small>Buffalo State College</small></i><br>
                    <i><small>1300 Elmwood Avenue</small></i><br>
                    <i><small>Buffalo, New York 14222</small></i>
                </p>
            </div>
        </footer>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        
    </body>

</html>